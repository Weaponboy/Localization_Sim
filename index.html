<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
        crossorigin="anonymous"></script>

    <style>
        body {
            background-color: rgb(114, 114, 114);
            user-select: none;
        }

        #backround {
            border-color: rgb(71, 70, 70);
            position: absolute;
            top: 3.7vw;
            left: 3.5vw;
            width: 39.3vw;
            height: 39.3vw;
        }

        #displayPath {
            font-size: 1.15vw;
            position: absolute;
            top: 28.8vw;
            left: 86vw;
            border-radius: 0.25vw;
            background-color: rgb(161, 161, 161);
        }

        #openPathFromFile {
            font-size: 1.15vw;
            position: absolute;
            top: 28.8vw;
            left: 61vw;
            border-radius: 0.25vw;
            z-index: 200;
            background-color: rgb(161, 161, 161);
        }

        #downloadData {
            font-size: 1.15vw;
            position: absolute;
            top: 28.8vw;
            left: 72.5vw;
            border-radius: 0.25vw;
            background-color: rgb(161, 161, 161);
        }

        #openPathFromFile :hover {
            background-color: rgb(0, 17, 255);
            z-index: 200;
        }

        .point {
            width: 0.125vw;
            height: 0.125vw;
            background-color: rgb(0, 255, 34);
            /* Make it round */
            position: absolute;
        }

        .pointStatic {
            width: 0.125vw;
            height: 0.125vw;
            z-index: 200;
            background-color: rgb(204, 0, 255);
            position: absolute;
        }

        #mySlider {
            position: absolute;
            top: 45vw;
            left: 7.8vw;
            width: 30vw;
            background: #d3d3d3;
            outline: none;
            opacity: 0.7;
            -webkit-transition: .2s;
            transition: opacity .2s;
        }

        #robotPos {
            display: none;
            width: 0.5vw;
            height: 0.5vw;
            background-color: red;
            border-radius: 50%;
            position: absolute;
            z-index: 100;
        }

        .yLabel {
            font-size: 1.1vw;
            padding-right: 0.2vw !important;
            padding-left: 0.2vw !important;
            font-weight: 600;
            padding: 0;
        }

        .xLabel {
            font-size: 1.1vw;
            padding-right: 0.2vw !important;
            font-weight: 600;
            padding: 0;
        }

        .pointBox {
            text-align: center;
            height: 1.8vw !important;
            width: 100%;
            margin: 0.1vw;
        }

        .pointChecks {
            vertical-align: middle;
            margin-top: 0.125vw;
        }

        .checkLabel {
            font-size: 1.4vw;
            font-weight: 600;
            padding: 0;
            margin: 0%;
            margin-left: 0.25vw;
            margin-right: 0.45vw;
            margin-bottom: 0.4vw;
            vertical-align: middle;
        }

        .valueLabel {
            width: 4.9vw;
            height: 1.45vw;
            border-radius: 0.125vw;
            vertical-align: middle;
            /* margin-top: 0.25vw; */
            font-size: 1.1vw;
            font-weight: 500;
            background-color: rgb(161, 161, 161);
            margin-bottom: 0.15vw;
        }

        .pathHeadings {
            font-size: 1.4vw;
            font-weight: 600;
            font-family: Arial, Helvetica, sans-serif;
            padding: 0;
            margin: 0;
        }

        .pathHeadingsBox {
            text-align: center;
            width: 100%;
            accent-color: rgba(2, 52, 82, 0.822);
            height: 2vw;
        }

        .pointBoxes {
            width: 100%;
            height: 11vw;
        }

        .pointChecks {
            accent-color: rgba(2, 52, 82, 0.822);
            width: 1.01vw;
            height: 1.01vw;
        }

        .borderBox {
            text-align: left;
            font-size: 1.2vw;
            font-weight: 500;
            border-style: solid;
            padding-bottom: 0 !important;
            padding-top: 0 !important;
            margin-top: 0 !important;
            border-width: 0.2vw;
            width: 100%;
            margin-bottom: 0.3vw;
        }

        .groupBox {
            margin-top: 0.4vw;
            width: 13.5vw;
            padding-left: 6%;
        }

        .valuesDisplay {
            text-align: left;
            margin: 0;
            font-size: 1.1vw;
            font-weight: 500;
            padding-top: 0.3vw;
            display: inline-block;
        }

        .labelDisplay {
            text-align: left;
            margin: 0;
            font-size: 1.1vw;
            font-weight: 500;
            padding-top: 0.3vw;
            padding-bottom: 0.3vw;
            padding-left: 0.3vw;
            display: inline-block;
        }

        .bigCheck {
            width: 1.2vw;
            height: 1.2vw;
        }

        #robotBorder {
            display: none;
            width: 4.4vw;
            height: 4.4vw;
            background: none;
            border-style: solid;
            border-color: (255, 0, 0);
            border-width: 0.2vw;
            position: absolute;
            z-index: 100;
        }
    </style>

</head>

<body>

    <div id="drop_zone" style="height: 43vw; width: 43vw;">

        <h1 style="font-size: 1.4vw; text-align: center; margin-top: 1.4vw; padding-left: 3vw;">Field View</h1>

        <img ondrop="dropHandler(event);" ondragover="dragOverHandler(event);"
            src="images/custom-centerstage-field-diagrams-works-with-meepmeep-v0-uqcy8o9sfpob1.png" id="backround"
            alt="">

        <div id="robotPos"></div>

        <div id="robotBorder"></div>

    </div>

    <input type="range" min="0" max="0" value="0" class="slider" id="mySlider">
    <div id="sliderValue" style="position: absolute; top: 46.5vw; left: 22vw;">50</div>
    <div id="start" style="position: absolute; top: 44.65vw; left: 6vw;">0</div>
    <div id="end" style="position: absolute; top: 44.65vw; left: 39vw;">100</div>

    <div
        style="position: absolute; top: 3.6vw; left: 43.6vw; height: 39.5vw; width: 14.5vw; background-color: rgb(83, 92, 94); border-style: solid; border-radius: 0.5vw; border-width: 0.25vw; color: black;">

        <div id="globalPosition" class="groupBox">
            <h1 style="font-size: 1.4vw; margin: 0.5vw;">Global Odometry Position</h1>
            <div class="borderBox">
                <h2 class="labelDisplay">
                    X:
                </h2>
                <h2 id="XPosition" class="valuesDisplay">
                    0
                </h2>
            </div>
            <div class="borderBox">
                <h2 class="labelDisplay">
                    Y:
                </h2>
                <h2 id="YPosition" class="valuesDisplay">
                    0
                </h2>
            </div>
            <div class="borderBox">
                <h2 class="labelDisplay">
                    Heading:
                </h2>
                <h2 id="Heading" class="valuesDisplay">
                    0
                </h2>
            </div>
        </div>

        <div id="globalPosition" class="groupBox">
            <h1 style="font-size: 1.3vw; margin: 0.5vw;">Odometry Pod Readings</h1>
            <div class="borderBox">
                <h2 class="labelDisplay">
                    Left Pod:
                </h2>
                <h2 id="LeftPod" class="valuesDisplay">
                    0
                </h2>
            </div>
            <div class="borderBox">
                <h2 class="labelDisplay">
                    Right Pod:
                </h2>
                <h2 id="RightPod" class="valuesDisplay">
                    0
                </h2>
            </div>
            <div class="borderBox">
                <h2 class="labelDisplay">
                    Center Pod:
                </h2>
                <h2 id="CenterPod" class="valuesDisplay">
                    0
                </h2>
            </div>
        </div>

        <div id="globalPosition" class="groupBox">
            <h1 style="font-size: 1.3vw; margin: 0.5vw;">Global Robot Velocity</h1>
            <div class="borderBox">
                <h2 class="labelDisplay">
                    X Velocity:
                </h2>
                <h2 id="XVelo" class="valuesDisplay">
                    0
                </h2>
            </div>
            <div class="borderBox">
                <h2 class="labelDisplay">
                    Y Velocity:
                </h2>
                <h2 id="YVelo" class="valuesDisplay">
                    0
                </h2>
            </div>
            <div class="borderBox">
                <h2 class="labelDisplay">
                    H Velocity:
                </h2>
                <h2 id="HeadingVelo" class="valuesDisplay">
                    0
                </h2>
            </div>
        </div>

        <div class="groupBox" style="margin-top: 1.5vw;">
            <div class="borderBox">
                <h2 class="labelDisplay">
                    loop time:
                </h2>
                <h2 id="loopTimeDis" class="valuesDisplay">
                    0
                </h2>
            </div>
        </div>

    </div>

    <div id="pointsStorage"
        style="position: absolute; top: 3.6vw; left: 59.5vw; height: 28.5vw; width: 37vw; background-color: rgb(83, 92, 94); color: black; border-radius: 0.7vw; border-style: solid;">

        <h1
            style="font-size: 2vw; font-family: Arial, Helvetica, sans-serif; text-align: center; font-weight: 600; margin: 0; padding-top: 0.4vw;">
            Path Planning</h1>

        <div style="width: 17vw; height: 22vw; position: absolute; top:3vw; left: 1.5vw;">
            <div id="firstPath" class="pointBoxes">
                <div class="pathHeadingsBox">
                    <input type="checkbox" id="Path1" class="bigCheck">
                    <label class="pathHeadings" for="Path1">Path 1</label>
                </div>
            </div>

            <div id="secondPath" class="pointBoxes">
                <div class="pathHeadingsBox">
                    <input type="checkbox" id="Path2" class="bigCheck">
                    <label class="pathHeadings" for="Path2">Path 2</label>
                </div>
            </div>
        </div>

        <div style="width: 17vw; float: inline-end; height: 22vw; position: absolute; top: 3vw; left: 18.5vw;">
            <div id="thirdPath" class="pointBoxes">
                <div class="pathHeadingsBox">
                    <input type="checkbox" id="Path3" class="bigCheck">
                    <label class="pathHeadings" for="Path3">Path 3</label>
                </div>
            </div>

            <div id="forthPath" class="pointBoxes">
                <div class="pathHeadingsBox">
                    <input type="checkbox" id="Path4" class="bigCheck">
                    <label class="pathHeadings" for="Path4">Path 4</label>
                </div>
            </div>
        </div>


    </div>

    <button onclick="PlanPath()" id="displayPath">Build Path Data</button>
    <button id="downloadData">Download Path Data</button>
    <button id="openPathFromFile">Open Path Data</button>
    <input type="file" id="fileinput" accept=".txt" style="display: none;">
    <pre id="pathingContent" style="white-space: pre-wrap;"></pre>

    <script>

        window.onload = function () {

            //id, label, containerId
            generateDivBox('1p1', 'P1', 'firstPath', true, true);
            generateDivBox('1p2', 'P2', 'firstPath', true, true);
            generateDivBox('1p3', 'P3', 'firstPath', false, false);
            generateDivBox('1p4', 'P4', 'firstPath', false, false);

            //id, label, containerId
            generateDivBox('2p1', 'P1', 'secondPath', true, true);
            generateDivBox('2p2', 'P2', 'secondPath', true, true);
            generateDivBox('2p3', 'P3', 'secondPath', false, false);
            generateDivBox('2p4', 'P4', 'secondPath', false, false);

            //id, label, containerId
            generateDivBox('3p1', 'P1', 'thirdPath', true, true);
            generateDivBox('3p2', 'P2', 'thirdPath', true, true);
            generateDivBox('3p3', 'P3', 'thirdPath', false, false);
            generateDivBox('3p4', 'P4', 'thirdPath', false, false);

            //id, label, containerId
            generateDivBox('4p1', 'P1', 'forthPath', true, true);
            generateDivBox('4p2', 'P2', 'forthPath', true, true);
            generateDivBox('4p3', 'P3', 'forthPath', false, false);
            generateDivBox('4p4', 'P4', 'forthPath', false, false);

            pathsChecked('Path1', 'Path2', 'Path3', 'Path4');

            thridPoint1('1p3tick', '1p4tick')
            thridPoint1('2p3tick', '2p4tick')
            thridPoint1('3p3tick', '3p4tick')
            thridPoint1('4p3tick', '4p4tick')

            const containerTest = document.getElementById('pointsStorage');

            function handleInputChange(event) {

                PlanPath();

                var point2 = document.getElementById("Path2");
                var point3 = document.getElementById("Path3");
                var point4 = document.getElementById("Path4");

                if (point2.checked) {
                    var point32 = document.getElementById("1p3tick");
                    var point42 = document.getElementById("1p4tick");

                    startPoint(2, point32.checked, point42.checked)
                }

                if (point3.checked) {
                    var point33 = document.getElementById("2p3tick");
                    var point43 = document.getElementById("2p4tick");

                    startPoint(3, point33.checked, point43.checked)
                }

                if (point4.checked) {
                    var point34 = document.getElementById("3p3tick");
                    var point44 = document.getElementById("3p4tick");

                    startPoint(4, point34.checked, point44.checked)
                }


            }

            function updatePointsInput(event) {
                var point2 = document.getElementById("Path2");
                var point3 = document.getElementById("Path3");
                var point4 = document.getElementById("Path4");

                if (point2.checked) {
                    var point32 = document.getElementById("1p3tick");
                    var point42 = document.getElementById("1p4tick");

                    startPoint(2, point32.checked, point42.checked)
                }

                if (point3.checked) {
                    var point33 = document.getElementById("2p3tick");
                    var point43 = document.getElementById("2p4tick");

                    startPoint(3, point33.checked, point43.checked)
                }

                if (point4.checked) {
                    var point34 = document.getElementById("3p3tick");
                    var point44 = document.getElementById("3p4tick");

                    startPoint(4, point34.checked, point44.checked)
                }

                updateBuildPatten();


                PlanPath();
            }


            if (containerTest) {
                containerTest.querySelectorAll('input[type="number"]').forEach(input => {
                    console.log('Attaching listener to input:', input);
                    input.addEventListener('input', handleInputChange);
                });

                containerTest.querySelectorAll('input[type="checkbox"]').forEach(input => {
                    console.log('Attaching listener to input:', input);
                    input.addEventListener('input', updatePointsInput);
                });
            } else {
                console.error('Container element not found.');
            }

        };

        var slider = document.getElementById("mySlider");
        var output = document.getElementById("sliderValue");
        var end = document.getElementById("end");
        var start = document.getElementById("start");

        output.innerHTML = slider.value;

        var paths = 0;
        var points = [];

        var loopTime = [];

        var xValues = [];
        var yValues = [];
        var headingValues = [];

        var xVelo = [];
        var yVelo = [];
        var headingVelo = [];

        var leftPod = [];
        var rightPod = [];
        var centerPod = [];

        var createdPoints = [];
        var createdPointsStatic = [];

        var xpoints = [];
        var ypoints = [];

        function thridPoint1(point3, point4) {
            var Point3 = document.getElementById(point3);
            var Point4 = document.getElementById(point4);

            Point3.addEventListener('change', function () {

                if (Point3.checked) {
                } else {
                    Point4.checked = false;
                }

                updateBuildPatten();

            });

            Point4.addEventListener('change', function () {

                if (Point4.checked) {
                    Point3.checked = true;
                } else {

                }

                updateBuildPatten();

            });

        }

        function pathsChecked(path1, path2, path3, path4) {

            var checkbox1 = document.getElementById(path1);
            var checkbox2 = document.getElementById(path2);

            var checkbox3 = document.getElementById(path3);
            var checkbox4 = document.getElementById(path4);

            checkbox1.addEventListener('change', function () {
                if (checkbox1.checked) {

                } else {
                    checkbox2.checked = false;
                    checkbox3.checked = false;
                    checkbox4.checked = false;
                }
                updateBuildPatten();

            });

            checkbox2.addEventListener('change', function () {
                if (checkbox2.checked) {
                    checkbox1.checked = true;

                    // var point32 = document.getElementById("1p3tick");
                    // var point42 = document.getElementById("1p4tick");

                    // startPoint(2, point32.checked, point42.checked)

                } else {
                    checkbox3.checked = false;
                    checkbox4.checked = false;
                }
                updateBuildPatten();

            });

            checkbox3.addEventListener('change', function () {
                if (checkbox3.checked) {
                    checkbox1.checked = true;
                    checkbox2.checked = true;

                    // var point32 = document.getElementById("1p3tick");
                    // var point42 = document.getElementById("1p4tick");

                    // startPoint(2, point32.checked, point42.checked)

                    // var point33 = document.getElementById("2p3tick");
                    // var point43 = document.getElementById("2p4tick");

                    // startPoint(3, point33.checked, point43.checked)

                } else {
                    checkbox4.checked = false;
                }
                updateBuildPatten();

            });

            checkbox4.addEventListener('change', function () {
                if (checkbox4.checked) {
                    checkbox1.checked = true;
                    checkbox2.checked = true;
                    checkbox3.checked = true;

                    // var point32 = document.getElementById("1p3tick");
                    // var point42 = document.getElementById("1p4tick");

                    // startPoint(2, point32.checked, point42.checked)

                    // var point33 = document.getElementById("2p3tick");
                    // var point43 = document.getElementById("2p4tick");

                    // startPoint(3, point33.checked, point43.checked)

                    // var point34 = document.getElementById("3p3tick");
                    // var point44 = document.getElementById("3p4tick");

                    // startPoint(4, point34.checked, point44.checked)
                } else {
                }

                updateBuildPatten();

            });

        }

        function startPoint(startNumber, third, forth) {

            var pointToInputX = document.getElementById(startNumber + "p1X");
            var pointToInputY = document.getElementById(startNumber + "p1Y");

            if (forth) {
                var pointToGetX = document.getElementById(startNumber - 1 + "p4X").value;
                var pointToGetY = document.getElementById(startNumber - 1 + "p4Y").value;

                console.log("third point added")

                pointToInputX.value = pointToGetX;
                pointToInputY.value = pointToGetY;
            } else if (third) {
                var pointToGetX = document.getElementById(startNumber - 1 + "p3X").value;
                var pointToGetY = document.getElementById(startNumber - 1 + "p3Y").value;

                console.log("forth point added")

                pointToInputX.value = pointToGetX;
                pointToInputY.value = pointToGetY;
            } else {
                var pointToGetX = document.getElementById(startNumber - 1 + "p2X").value;
                var pointToGetY = document.getElementById(startNumber - 1 + "p2Y").value;

                console.log("third point added")

                pointToInputX.value = pointToGetX;
                pointToInputY.value = pointToGetY;
            }

        }

        slider.oninput = function () {
            output.innerHTML = this.value;
            updateDisplay();
            createPoints();
            if (this.value === 0) {
                var robotPosition = document.getElementById("robotPos");
                robotPosition.style.display = "none";
            }
        }

        function generateDivBox(id, label, containerId, isChecked = false, isDisabled = false) {

            const container = document.getElementById(containerId);

            const divBox = document.createElement('div');
            divBox.className = 'pointBox';

            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.id = `${id}tick`;
            checkbox.className = 'pointChecks';
            checkbox.checked = isChecked;
            checkbox.disabled = isDisabled;

            const checkLabel = document.createElement('label');
            checkLabel.htmlFor = `${id}tick`;
            checkLabel.className = 'checkLabel';
            checkLabel.innerText = `${label}:`;

            const xLabel = document.createElement('label');
            xLabel.htmlFor = `${id}X`;
            xLabel.className = 'xLabel';
            xLabel.innerText = 'X';

            const xInput = document.createElement('input');
            xInput.type = 'number';
            xInput.min = 0;
            xInput.max = 360;
            xInput.id = `${id}X`;
            xInput.className = 'valueLabel';

            const yLabel = document.createElement('label');
            yLabel.htmlFor = `${id}Y`;
            yLabel.className = 'yLabel';
            yLabel.innerText = 'Y';

            const yInput = document.createElement('input');
            yInput.type = 'number';
            yInput.min = 0;
            yInput.max = 360;
            yInput.id = `${id}Y`;
            yInput.className = 'valueLabel';

            divBox.appendChild(checkbox);
            divBox.appendChild(checkLabel);

            divBox.appendChild(xLabel);
            divBox.appendChild(xInput);

            divBox.appendChild(yLabel);
            divBox.appendChild(yInput);

            container.appendChild(divBox);
        }

        function updateDisplay() {
            var LoopTime = document.getElementById("loopTimeDis");

            var XPosition = document.getElementById("XPosition");
            var YPosition = document.getElementById("YPosition");
            var Heading = document.getElementById("Heading");

            var LeftPod = document.getElementById("LeftPod");
            var RightPod = document.getElementById("RightPod");
            var CenterPod = document.getElementById("CenterPod");

            var XVelo = document.getElementById("XVelo");
            var YVelo = document.getElementById("YVelo");
            var HeadingVelo = document.getElementById("HeadingVelo");

            LoopTime.innerHTML = loopTime[slider.value]

            XPosition.innerHTML = xValues[slider.value]
            YPosition.innerHTML = yValues[slider.value]
            Heading.innerHTML = headingValues[slider.value]

            LeftPod.innerHTML = leftPod[slider.value]
            RightPod.innerHTML = rightPod[slider.value]
            CenterPod.innerHTML = centerPod[slider.value]

            XVelo.innerHTML = xVelo[slider.value]
            YVelo.innerHTML = yVelo[slider.value]
            HeadingVelo.innerHTML = headingVelo[slider.value]

        }

        function dragOverHandler(event) {
            event.preventDefault();
            event.dataTransfer.dropEffect = 'copy';
        }

        function dropHandler(event) {
            event.preventDefault();
            var files = event.dataTransfer.files;
            if (files.length > 0) {
                var file = files[0];
                var reader = new FileReader();
                reader.onload = function (e) {
                    var content = e.target.result;
                    parseFileContent(content);
                    slider.max = loopTime.length - 1;
                    end.innerHTML = loopTime.length - 1;
                };
                reader.readAsText(file);
            }
        }

        function parseFileContent(content) {

            slider.value = 0;

            if (xValues.length > 0) {
                output.innerHTML = slider.value;
                updateDisplay();
                createPoints();
            }

            loopTime.length = 0;

            xValues.length = 0;
            yValues.length = 0;
            headingValues.length = 0;

            xVelo.length = 0;
            yVelo.length = 0;
            headingVelo.length = 0;

            leftPod.length = 0;
            rightPod.length = 0;
            centerPod.length = 0;

            var lines = content.split('\n');
            for (var i = 0; i < lines.length; i++) {

                var line = lines[i].trim();
                var parts = line.split(':');

                if (parts.length === 2) {

                    if (parts[0].trim().startsWith('loop time')) {
                        loopTime.push(parseFloat(parts[1]));
                    }

                    if (parts[0].trim().startsWith('X Position')) {
                        xValues.push(parseFloat(parts[1]));
                    } else if (parts[0].trim().startsWith('Y Position')) {
                        yValues.push(parseFloat(parts[1]));
                    } else if (parts[0].trim().startsWith('Heading Position')) {
                        headingValues.push(parseFloat(parts[1]));
                    }

                    if (parts[0].trim().startsWith('X Velocity')) {
                        xVelo.push(parseFloat(parts[1]));
                    } else if (parts[0].trim().startsWith('Y Velocity')) {
                        yVelo.push(parseFloat(parts[1]));
                    } else if (parts[0].trim().startsWith('Heading Velocity')) {
                        headingVelo.push(parseFloat(parts[1]));
                    }

                    if (parts[0].trim().startsWith('Left Pod')) {
                        leftPod.push(parseFloat(parts[1]));
                    } else if (parts[0].trim().startsWith('Right Pod')) {
                        rightPod.push(parseFloat(parts[1]));
                    } else if (parts[0].trim().startsWith('Center Pod')) {
                        centerPod.push(parseFloat(parts[1]));
                    }

                }
            }
        }

        function displayParsedData() {
            console.log("Numbers: ", loopTime);
            console.log("X Values: ", xValues);
            console.log("Y Values: ", yValues);
            console.log("left: ", leftPod);
            console.log("right: ", rightPod);
            console.log("center: ", centerPod);
        }

        function createPoints() {

            deletePoints();

            var dropZone = document.getElementById("drop_zone");

            for (var i = 0; i < slider.value; i++) {
                var point = document.createElement("div");
                point.className = "point";
                point.style.top = -((xValues[i] * 0.109)) + 42.8 + "vw";
                point.style.left = (yValues[i] * 0.109) + 3.5 + "vw";
                dropZone.appendChild(point);

                createdPoints.push(point);
            }

            var robotBorder = document.getElementById("robotBorder");
            robotBorder.style.top = -((xValues[slider.value] * 0.109)) + 40.7 + "vw";
            robotBorder.style.left = (yValues[slider.value] * 0.109) + 1.3 + "vw";
            var heading = headingValues[slider.value];
            // robotBorder.style.transform = `rotate(${heading}deg)`;
            robotBorder.style.display = "block";


            var robotPosition = document.getElementById("robotPos");
            robotPosition.style.top = -((xValues[slider.value] * 0.109)) + 42.6 + "vw";
            robotPosition.style.left = (yValues[slider.value] * 0.109) + 3.3 + "vw";
            robotPosition.style.display = "block";
        }

        function deletePoints() {
            var dropZone = document.getElementById("drop_zone");
            createdPoints.forEach(function (point) {
                dropZone.removeChild(point);
            });
            createdPoints = [];
        }

        function PlanPath() {

            xpoints.length = 0;
            ypoints.length = 0;

            for (let i = 0; i < paths; i++) {

                console.log(i);

                if (points[i] == 2) {
                    const startX = document.getElementById(i + 1 + 'p1X').value;
                    const startY = document.getElementById(i + 1 + 'p1Y').value;

                    const endX = document.getElementById(i + 1 + 'p2X').value;
                    const endY = document.getElementById(i + 1 + 'p2Y').value;

                    calculateLinearBezier(startX, startY, endX, endY);

                } else if (points[i] == 3) {
                    const startX = document.getElementById(i + 1 + 'p1X').value;
                    const startY = document.getElementById(i + 1 + 'p1Y').value;

                    const secondX = document.getElementById(i + 1 + 'p2X').value;
                    const secondY = document.getElementById(i + 1 + 'p2Y').value;

                    const endX = document.getElementById(i + 1 + 'p3X').value;
                    const endY = document.getElementById(i + 1 + 'p3Y').value;

                    calculateQuadraticBezier(startX, startY, secondX, secondY, endX, endY);

                } else if (points[i] == 4) {
                    const startX = document.getElementById(i + 1 + 'p1X').value;
                    const startY = document.getElementById(i + 1 + 'p1Y').value;

                    const secondX = document.getElementById(i + 1 + 'p2X').value;
                    const secondY = document.getElementById(i + 1 + 'p2Y').value;

                    const thirdX = document.getElementById(i + 1 + 'p3X').value;
                    const thirdY = document.getElementById(i + 1 + 'p3Y').value;

                    const endX = document.getElementById(i + 1 + 'p4X').value;
                    const endY = document.getElementById(i + 1 + 'p4Y').value;

                    calculateCubicBezier(startX, startY, secondX, secondY, thirdX, thirdY, endX, endY);

                }

            }

            // console.log(xpoints);
            // console.log(ypoints);
            createPointsStatic();

        }

        function getFirstPathData() {

            var allPoints;

            var xText1 = '1p1X: ' + document.getElementById('1p1X').value;
            var xText2 = '1p2X: ' + document.getElementById('1p2X').value;
            var xText3 = '1p3X: ' + document.getElementById('1p3X').value;
            var xText4 = '1p4X: ' + document.getElementById('1p4X').value;

            var yText1 = '1p1Y: ' + document.getElementById('1p1Y').value;
            var yText2 = '1p2Y: ' + document.getElementById('1p2Y').value;
            var yText3 = '1p3Y: ' + document.getElementById('1p3Y').value;
            var yText4 = '1p4Y: ' + document.getElementById('1p4Y').value;

            allPoints = xText1 + '\n' + xText2 + '\n' + xText3 + '\n' + xText4 + '\n' + yText1 + '\n' + yText2 + '\n' + yText3 + '\n' + yText4;

            return allPoints;
        }

        function getSecondPathData() {

            var allPoints;

            var xText1 = '2p1X: ' + document.getElementById('2p1X').value;
            var xText2 = '2p2X: ' + document.getElementById('2p2X').value;
            var xText3 = '2p3X: ' + document.getElementById('2p3X').value;
            var xText4 = '2p4X: ' + document.getElementById('2p4X').value;

            var yText1 = '2p1Y: ' + document.getElementById('2p1Y').value;
            var yText2 = '2p2Y: ' + document.getElementById('2p2Y').value;
            var yText3 = '2p3Y: ' + document.getElementById('2p3Y').value;
            var yText4 = '2p4Y: ' + document.getElementById('2p4Y').value;

            allPoints = xText1 + '\n' + xText2 + '\n' + xText3 + '\n' + xText4 + '\n' + yText1 + '\n' + yText2 + '\n' + yText3 + '\n' + yText4;

            return allPoints;
        }

        function getThirdPathData() {

            var allPoints;

            var xText1 = '3p1X: ' + document.getElementById('3p1X').value;
            var xText2 = '3p2X: ' + document.getElementById('3p2X').value;
            var xText3 = '3p3X: ' + document.getElementById('3p3X').value;
            var xText4 = '3p4X: ' + document.getElementById('3p4X').value;

            var yText1 = '3p1Y: ' + document.getElementById('3p1Y').value;
            var yText2 = '3p2Y: ' + document.getElementById('3p2Y').value;
            var yText3 = '3p3Y: ' + document.getElementById('3p3Y').value;
            var yText4 = '3p4Y: ' + document.getElementById('3p4Y').value;

            allPoints = xText1 + '\n' + xText2 + '\n' + xText3 + '\n' + xText4 + '\n' + yText1 + '\n' + yText2 + '\n' + yText3 + '\n' + yText4;

            return allPoints;
        }

        function getForthPathData() {

            var allPoints;

            var xText1 = '4p1X: ' + document.getElementById('4p1X').value;
            var xText2 = '4p2X: ' + document.getElementById('4p2X').value;
            var xText3 = '4p3X: ' + document.getElementById('4p3X').value;
            var xText4 = '4p4X: ' + document.getElementById('4p4X').value;

            var yText1 = '4p1Y:' + document.getElementById('4p1Y').value;
            var yText2 = '4p2Y:' + document.getElementById('4p2Y').value;
            var yText3 = '4p3Y:' + document.getElementById('4p3Y').value;
            var yText4 = '4p4Y:' + document.getElementById('4p4Y').value;

            allPoints = xText1 + '\n' + xText2 + '\n' + xText3 + '\n' + xText4 + '\n' + yText1 + '\n' + yText2 + '\n' + yText3 + '\n' + yText4;

            return allPoints;
        }

        document.getElementById('downloadData').addEventListener('click', function () {

            var path1Points = getFirstPathData();
            var path2Points = getSecondPathData();
            var path3Points = getThirdPathData();
            var path4Points = getForthPathData();

            var filename = prompt("Please enter the filename", "Pathing Points");

            if (filename) {
                var combinedText = path1Points + '\n' + path2Points + '\n' + path3Points + '\n' + path4Points;

                var blob = new Blob([combinedText], { type: 'text/plain' });

                var link = document.createElement('a');

                link.download = filename;

                link.href = window.URL.createObjectURL(blob);

                document.body.appendChild(link);

                link.click();

                document.body.removeChild(link);
            }

        });

        document.getElementById('openPathFromFile').addEventListener('click', function () {
            document.getElementById('fileinput').click();
        });

        document.getElementById('fileinput').addEventListener('change', function (event) {
            var file = event.target.files[0];

            if (file) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    var content = e.target.result;
                    inputPathingPoints(content);
                };

                reader.readAsText(file);
            }
        });

        function inputPathingPoints(content) {

            var lines = content.split('\n');

            for (var i = 0; i < lines.length; i++) {

                var line = lines[i].trim();
                var parts = line.split(':');

                if (parts.length === 2) {

                    //first points
                    if (parts[0].trim().startsWith('1p1X')) {
                        document.getElementById('1p1X').value = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('1p2X')) {
                        var Text = document.getElementById('1p2X');
                        Text.value = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('1p3X')) {
                        var Text = document.getElementById('1p3X');
                        Text.value = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('1p4X')) {
                        var Text = document.getElementById('1p4X');
                        Text.value = parseFloat(parts[1])
                    }

                    if (parts[0].trim().startsWith('1p1Y')) {
                        var Text = document.getElementById('1p1Y');
                        Text.value = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('1p2Y')) {
                        var Text = document.getElementById('1p2Y');
                        Text.value = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('1p3Y')) {
                        var Text = document.getElementById('1p3Y');
                        Text.value = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('1p4Y')) {
                        var Text = document.getElementById('1p4Y');
                        Text.value = parseFloat(parts[1])
                    }

                    //second points
                    if (parts[0].trim().startsWith('2p1X')) {
                        var Text = document.getElementById('2p1X');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('2p2X')) {
                        var Text = document.getElementById('2p2X');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('2p3X')) {
                        var Text = document.getElementById('2p3X');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('2p4X')) {
                        var Text = document.getElementById('2p4X');
                        Text.innerHTML = parseFloat(parts[1])
                    }

                    if (parts[0].trim().startsWith('2p1Y')) {
                        var Text = document.getElementById('2p1Y');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('2p2Y')) {
                        var Text = document.getElementById('2p2Y');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('2p3Y')) {
                        var Text = document.getElementById('2p3Y');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('2p4Y')) {
                        var Text = document.getElementById('2p4Y');
                        Text.innerHTML = parseFloat(parts[1])
                    }

                    //third points
                    if (parts[0].trim().startsWith('3p1X')) {
                        var Text = document.getElementById('3p1X');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('3p2X')) {
                        var Text = document.getElementById('3p2X');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('3p3X')) {
                        var Text = document.getElementById('3p3X');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('3p4X')) {
                        var Text = document.getElementById('3p4X');
                        Text.innerHTML = parseFloat(parts[1])
                    }

                    if (parts[0].trim().startsWith('3p1Y')) {
                        var Text = document.getElementById('3p1Y');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('3p2Y')) {
                        var Text = document.getElementById('3p2Y');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('3p3Y')) {
                        var Text = document.getElementById('3p3Y');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('3p4Y')) {
                        var Text = document.getElementById('3p4Y');
                        Text.innerHTML = parseFloat(parts[1])
                    }

                    //forth points
                    if (parts[0].trim().startsWith('4p1X')) {
                        var Text = document.getElementById('4p1X');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('4p2X')) {
                        var Text = document.getElementById('4p2X');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('4p3X')) {
                        var Text = document.getElementById('4p3X');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('4p4X')) {
                        var Text = document.getElementById('4p4X');
                        Text.innerHTML = parseFloat(parts[1])
                    }

                    if (parts[0].trim().startsWith('4p1Y')) {
                        var Text = document.getElementById('4p1Y');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('4p2Y')) {
                        var Text = document.getElementById('4p2Y');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('4p3Y')) {
                        var Text = document.getElementById('4p3Y');
                        Text.innerHTML = parseFloat(parts[1])
                    } else if (parts[0].trim().startsWith('4p4Y')) {
                        var Text = document.getElementById('4p4Y');
                        Text.innerHTML = parseFloat(parts[1])
                    }

                }
            }
        }

        function updateBuildPatten() {
            points.length = 0;
            paths = 0;

            for (let i = 1; i < 5; i++) {

                var pathCheck = document.getElementById('Path' + i)
                console.log(pathCheck.checked + pathCheck.id)

                if (pathCheck.checked === true) {
                    paths++;
                } else {
                    i = 10;
                }

            }

            for (let i = 1; i < paths + 1; i++) {

                for (let j = 1; j < 5; j++) {

                    var pathCheck = document.getElementById(i + 'p' + j + 'tick')

                    console.log(pathCheck.checked + pathCheck.id)

                    if (pathCheck.checked === true) {
                    } else {
                        points.push(j - 1)
                        j = 10;
                    }

                    if (j === 4 && pathCheck.checked === true) {
                        points.push(j)

                    }
                }
            }

            console.log(paths)
            console.log(points)
        }

        function calculateCubicBezier(startX, startY, controlFirstX, controlFirstY, controlSecondX, controlSecondY, endX, endY) {

            let t = 0;

            while (t <= 1) {
                const u = 1 - t;
                const tt = t * t;
                const ttt = t * t * t;
                const uu = u * u;
                const uuu = u * u * u;

                xpoints.push(uuu * startX + 3 * uu * t * controlFirstX + 3 * u * tt * controlSecondX + ttt * endX);
                ypoints.push(uuu * startY + 3 * uu * t * controlFirstY + 3 * u * tt * controlSecondY + ttt * endY);

                t += 0.001;
            }

        }

        function calculateQuadraticBezier(startX, startY, controlX, controlY, endX, endY) {

            let t = 0;

            while (t <= 1) {
                const u = 1 - t;
                const tt = t * t;
                const uu = u * u;

                const x = uu * startX + 2 * u * t * controlX + tt * endX;
                const y = uu * startY + 2 * u * t * controlY + tt * endY;

                xpoints.push(x);
                ypoints.push(y);

                t += 0.001;
            }

            return { xpoints, ypoints };
        }

        function calculateLinearBezier(startX, startY, endX, endY) {

            let t = 0;

            while (t <= 1) {
                const x = (1 - t) * startX + t * endX;
                const y = (1 - t) * startY + t * endY;

                xpoints.push(x);
                ypoints.push(y);

                t += 0.001;
            }

        }

        function createPointsStatic() {

            deletePointsStatic();

            var dropZone = document.getElementById("drop_zone");

            for (var i = 0; i < xpoints.length; i++) {
                var point = document.createElement("div");
                point.className = "pointStatic";
                point.style.top = -((xpoints[i] * 0.109)) + 42.8 + "vw";
                point.style.left = (ypoints[i] * 0.109) + 3.5 + "vw";
                dropZone.appendChild(point);

                createdPointsStatic.push(point);
            }

        }

        function deletePointsStatic() {
            var dropZone = document.getElementById("drop_zone");
            createdPointsStatic.forEach(function (pointStatic) {
                dropZone.removeChild(pointStatic);
            });
            createdPointsStatic = [];
        }

    </script>

</body>

</html>